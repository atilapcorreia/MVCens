% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mvsn_censored.R
\name{rmatrix_censored}
\alias{rmatrix_censored}
\title{Generate Matrix Variate Normal or Skew Normal Data with Censoring}
\usage{
rmatrix_censored(
  n = n,
  cens = cens,
  Ind = 1,
  M = M,
  U = U,
  V = V,
  A = A,
  dist = "SN"
)
}
\arguments{
\item{n}{Integer. Number of generated matrices.}

\item{cens}{Numeric between 0 and 1. Censoring proportion used as the
quantile cutoff. For example, cens = 0.15 means censoring values below
the 15 percent quantile.}

\item{Ind}{Integer indicating the type of censoring:
1 = symmetric interval censoring (left and right),
2 = missing,
3 = mixed censoring (half missing values and half censored values).}

\item{M}{Mean matrix with dimensions p by q.}

\item{U}{Row covariance matrix with dimensions p by p.}

\item{V}{Column covariance matrix with dimensions q by q.}

\item{A}{Skewness matrix with dimensions p by q. Used only when
dist = "SN".}

\item{dist}{Character string indicating the distribution. Use "Normal"
for MVN or "SN" for MVSN.}
}
\value{
A list with components:
\itemize{
\item \code{X.cens}: Censored data as an array of size p by q by n.
\item \code{cc}: Censoring indicator matrix (1 means censored, 0 means observed).
\item \code{LS}: Upper limits associated with censoring.
}
}
\description{
This function generates matrix-valued observations from either a Matrix Variate Normal
(MVN) or Matrix Variate Skew Normal (MVSN) distribution, optionally applying
missing or interval-censoring based on a quantile cutoff.
}
\details{
Matrix-variate data are generated using the function
LaplacesDemon::rmatrixnorm. When dist = "SN", skewness is introduced by
adding A multiplied by the absolute value of a standard normal draw.

Censoring is implemented using a quantile-based threshold controlled by
the argument cens. The mechanism is specified by Ind.
}
\examples{
# Example: Generate censored matrix-variate data from
#          Normal and Skew-Normal models

set.seed(123)

# Dimensions: matrices of size p x q, sample size n
p <- 2
q <- 2
n <- 20

# Model parameters
M <- matrix(0, p, q)        # Location matrix
U <- diag(p)                # Row covariance
V <- diag(q)                # Column covariance
A <- matrix(1, p, q)        # Skewness matrix

# censoring proportion
cens <- 0.15

# ---------------------------------------------------------
# 1) Generate censored MVN (Normal) matrix-variate data
# ---------------------------------------------------------
out_normal <- rmatrix_censored(
  n = n,
  cens = cens,
  Ind = 1,      # interval-censored
  M = M,
  U = U,
  V = V,
  A = A,
  dist = "Normal"
)

# Extract components
X_normal  <- out_normal$X.cens   # true observations or lower censoring limits
cc_normal <- out_normal$cc       # censoring indicators
LS_normal <- out_normal$LS       # upper censoring limits


# ---------------------------------------------------------
# 2) Generate censored MVSN (Skew-Normal) matrix data
# ---------------------------------------------------------
out_skew <- rmatrix_censored(
  n = n,
  cens = cens,
  Ind = 1,      # interval-censored
  M = M,
  U = U,
  V = V,
  A = A,
  dist = "SN"
)

# Extract components
X_skew  <- out_skew$X.cens
cc_skew <- out_skew$cc
LS_skew <- out_skew$LS

# Display the first generated matrix
X_skew[ , , 1]
}
