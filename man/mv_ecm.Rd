% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mvsn.R
\name{mv_ecm}
\alias{mv_ecm}
\title{ECM Algorithm for the MVN, MVSN, MVNC and MVSNC models}
\usage{
mv_ecm(
  dist,
  samples = NULL,
  cc = NULL,
  LS = NULL,
  precision = 1e-07,
  MaxIter = 50
)
}
\arguments{
\item{dist}{A character string specifying the distribution/model to be fitted.
Options are:
"MVN"   – Matrix Variate Normal,
"MVNC"  – Censored Matrix Variate Normal,
"MVSN"  – Matrix Variate Skew-Normal,
"MVSNC" – Censored Matrix Variate Skew-Normal.}

\item{samples}{A 3D array of dimension p × q × n containing the observed matrix-valued responses.
For uncensored entries, the array stores the observed values; for censored entries, it stores the lower limits..}

\item{cc}{A 3D indicator array with 1 for interval-censored entries and 0 for observed values.}

\item{LS}{A 3D array storing upper limits for interval-censored entries, and 0 for non-censored entries.}

\item{precision}{Convergence tolerance.}

\item{MaxIter}{Maximum number of iterations.}
}
\value{
A list with components:
\item{mu}{Estimated location matrix (p × q).}
\item{A}{Estimated skewness matrix (p × q). Returned only for MVSN and MVSNC models.}
\item{Sigma}{Estimated row covariance matrix (p × p).}
\item{Psi}{Estimated column covariance matrix (q × q).}
\item{loglik}{Final log-likelihood value achieved by the ECM algorithm.}
\item{BIC}{Bayesian Information Criterion.}
\item{iter}{Number of ECM iterations performed.}
}
\description{
This function provides a unified ECM-type estimation method for several matrix-variate distributions —
MVN, MVSN, MVNC, and MVSNC — allowing for data sets that include interval-censored or missing values.
}
\examples{

########################################################
# Example 1: Fit an MVNC model to simulated 2x2 matrices
########################################################

set.seed(123)

# Dimensions: p = 2, q = 2, n = 20
p <- 2
q <- 2
n <- 20

# True parameters
M   <- matrix(0, p, q)
A   <- matrix(0, p, q)
U   <- diag(p)
V   <- diag(q)

# Simulated incomplete data
samples <- rmatrix_censored(n = n,
                            cens = 0.15,
                            Ind = 1,
                            M = M,
                            U = U,
                            V = V,
                            A = A,
                            dist = "Normal")
dados <- samples$X.cens
cc    <- samples$cc
LS    <- samples$LS

# Run ECM algorithm for censored MVN model
out <- mv_ecm("MVNC", samples = dados, cc = cc, LS = LS, MaxIter = 20)

# Inspect estimated parameters
out$mu
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter

##################################################################
# Example 2: Fit an MVN model to simulated 2x2 matrix-variate data
##################################################################
set.seed(123)

# Dimensions: p = 2, q = 2, n = 20
p <- 2
q <- 2
n <- 20

# True parameters
M_true     <- matrix(0, p, q)
Sigma_true <- diag(p)
Psi_true   <- diag(q)

# Generate sample matrices from MVN(M_true, Sigma_true, Psi_true)
samples <- array(0, dim = c(p, q, n))
for (i in 1:n) {
  samples[ , , i] <- LaplacesDemon::rmatrixnorm(
    M = M_true,
    U = Sigma_true,
    V = Psi_true
  )
}

# Run ECM algorithm for the Matrix-Variate Normal model
out <- mv_ecm("MVN", samples = samples, cc = cc, LS = LS, MaxIter = 20)

# Inspect fitted parameters
out$mu
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter

###################################################################
# Example 3: Fit an MVSN model to simulated 2x2 matrix-variate data
###################################################################
p <- 3
q <- 2
n <- 20
M <- matrix(0, p, q)
A <- matrix(1, p, q)
U <- diag(p)
V <- diag(q)

# Generate simple test data

set.seed(123)
dados <- rmvsn(n = n, M = M, A = A, U = U, V = V)

out <- mv_ecm("MVSN", samples = dados, cc = cc, LS = LS, MaxIter = 20)
out$mu
out$A
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter

str(out)

####################################################################
# Example 4: Fit an MVSNC model to simulated 2x2 matrix-variate data
####################################################################

p <- 2
q <- 2
n <- 20
M <- matrix(0, p, q)
A <- matrix(1, p, q)
U <- diag(p)
V <- diag(q)

# Simulated incomplete data
samples <- rmatrix_censored(n = n, cens = 0.15, Ind = 1, M = M, U = U, V = V, A = A, dist = "SN")
dados <- samples$X.cens
cc    <- samples$cc
LS    <- samples$LS

out <- mv_ecm("MVSNC", samples = dados, cc = cc, LS = LS, MaxIter = 20)

out$mu
out$A
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter

str(out)
}
