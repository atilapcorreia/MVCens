usethis::use_package("LaplacesDemon")
usethis::use_package("Matrix")
usethis::use_package("matrixNormal")
usethis::use_package("mnormt")
usethis::use_package("MomTrunc")
usethis::use_package("mvtnorm")
usethis::use_package("stats")       # base package, optional
usethis::use_package("tlrmvnmvt")
devtools::document()
devtools::load_all()
devtools::check()
usethis::use_gpl3_license("Atila Correia")
usethis::use_mit_license("Atila Correia")
devtools::check()
devtools::build()
devtools::install()
library(MVCens)
?mv_ecm
# Dimensions: p = 2, q = 2, n = 20
p <- 2
q <- 2
n <- 20
# True parameters
M   <- matrix(0, p, q)
A   <- matrix(0, p, q)
U   <- diag(p)
V   <- diag(q)
# Simulated incomplete data
samples <- rmatrix_censored(n = n,
cens = 0.15,
Ind = 1,
M = M,
U = U,
V = V,
A = A,
dist = "Normal")
dados <- samples$X.cens
cc    <- samples$cc
LS    <- samples$LS
# Run ECM algorithm for censored MVN model
out <- mv_ecm("MVNC", samples = dados, cc = cc, LS = LS, MaxIter = 20)
# Inspect estimated parameters
out$mu
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter
# Dimensions: p = 2, q = 2, n = 20
p <- 2
q <- 2
n <- 20
# True parameters
M_true     <- matrix(0, p, q)
Sigma_true <- diag(p)
Psi_true   <- diag(q)
# Generate sample matrices from MVN(M_true, Sigma_true, Psi_true)
samples <- array(0, dim = c(p, q, n))
for (i in 1:n) {
samples[ , , i] <- LaplacesDemon::rmatrixnorm(
M = M_true,
U = Sigma_true,
V = Psi_true
)
}
# Run ECM algorithm for the Matrix-Variate Normal model
out <- mv_ecm("MVN", samples = samples, cc = cc, LS = LS, MaxIter = 20)
# Inspect fitted parameters
out$mu
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter
p <- 3
q <- 2
n <- 20
M <- matrix(0, p, q)
A <- matrix(1, p, q)
U <- diag(p)
V <- diag(q)
set.seed(123)
dados <- rmvsn(n = n, M = M, A = A, U = U, V = V)
out <- mv_ecm("MVSN", samples = dados, cc = cc, LS = LS, MaxIter = 20)
out$mu
out$A
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter
p <- 2
q <- 2
n <- 20
M <- matrix(0, p, q)
A <- matrix(1, p, q)
U <- diag(p)
V <- diag(q)
# Simulated incomplete data
samples <- rmatrix_censored(n = n, cens = 0.15, Ind = 1, M = M, U = U, V = V, A = A, dist = "SN")
dados <- samples$X.cens
cc    <- samples$cc
LS    <- samples$LS
out <- mv_ecm("MVSNC", samples = dados, cc = cc, LS = LS, MaxIter = 20)
out$mu
out$A
out$Sigma
out$Psi
out$loglik
out$BIC
out$iter
?rmatrix_censored
# Dimensions: matrices of size p x q, sample size n
p <- 2
q <- 2
n <- 20
# Model parameters
M <- matrix(0, p, q)        # Location matrix
U <- diag(p)                # Row covariance
V <- diag(q)                # Column covariance
A <- matrix(1, p, q)        # Skewness matrix
# censoring proportion
cens <- 0.15
# ---------------------------------------------------------
# 1) Generate censored MVN (Normal) matrix-variate data
# ---------------------------------------------------------
out_normal <- rmatrix_censored(
n = n,
cens = cens,
Ind = 1,      # interval-censored
M = M,
U = U,
V = V,
A = A,
dist = "Normal"
)
# Extract components
X_normal  <- out_normal$X.cens   # true observations or lower censoring limits
cc_normal <- out_normal$cc       # censoring indicators
LS_normal <- out_normal$LS       # upper censoring limits
# ---------------------------------------------------------
# 2) Generate censored MVSN (Skew-Normal) matrix data
# ---------------------------------------------------------
out_skew <- rmatrix_censored(
n = n,
cens = cens,
Ind = 1,      # interval-censored
M = M,
U = U,
V = V,
A = A,
dist = "SN"
)
# Extract components
X_skew  <- out_skew$X.cens
cc_skew <- out_skew$cc
LS_skew <- out_skew$LS
# Display the first generated matrix
X_skew[ , , 1]
devtools::check()
